<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ============================================== -->
    <!-- FAVICON & BRANDING -->
    <!-- ============================================== -->
    <link rel="icon" href="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10">
    <link rel="icon" type="image/png" sizes="32x32" href="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10">
    <link rel="icon" type="image/png" sizes="192x192" href="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10">
    <link rel="apple-touch-icon" sizes="180x180" href="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10">
    <link rel="shortcut icon" href="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10">

    <!-- Standard Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="color-scheme" content="only light">
    <title>FanPlusFollow</title>
    <meta name="description" content="Tools for Content Creators. Boost your reach with advanced insights.">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        :root { 
            font-family: 'Inter', sans-serif; 
            box-sizing: border-box;
            color-scheme: only light; 
            -webkit-tap-highlight-color: transparent;
        }

        html {
            /* Gemini Dark Grey #131314 */
            background-color: #131314; 
            scroll-behavior: smooth;
            height: 100%;
            width: 100%;
            overflow-x: hidden;
            overscroll-behavior: none;
        }

        body {
            background-color: transparent; 
            min-height: 100vh;
            color: #000000;
            margin: 0;
            padding: 0;
            overscroll-behavior: none;
            cursor: pointer;
        }

        /* --- STIFF STATIC BACKGROUND --- */
        #fixed-background {
            position: fixed;
            top: 0; left: 0; 
            width: 100vw; 
            height: 100vh;
            height: 100lvh; 
            min-height: 100%;
            z-index: -1; 
            background-image: url('background.png');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            opacity: 0; 
            transition: opacity 0.5s ease-out;
            pointer-events: none;
        }

        @media (min-width: 768px) {
            #fixed-background {
                background-image: url('landscape.png');
            }
        }

        /* Loading Screen */
        #initial-loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #131314; 
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.4s ease-out, visibility 0.4s;
        }

        .fluid-transition {
            transition: all 400ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform, box-shadow, filter, background-color, color, opacity; 
        }

        /* Entry Animation */
        @keyframes spiral-entry {
            0% { opacity: 0; transform: perspective(1000px) scale(0.95) translateY(20px); filter: blur(10px); }
            100% { opacity: 1; transform: perspective(1000px) scale(1) translateY(0); filter: blur(0); }
        }
        
        .card-animate {
            animation: spiral-entry 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0; 
        }
        
        #app-header.card-animate { animation-delay: 0.1s; }
        #upload-card.card-animate { animation-delay: 0.2s; } 
        #promo-card.card-animate { animation-delay: 0.3s; }

        .pre-load-hidden { opacity: 0; }

        /* Glass Card */
        .glass-card {
            background-color: rgba(255, 255, 255, 0.15);
            -webkit-backdrop-filter: blur(24px) saturate(110%);
            backdrop-filter: blur(24px) saturate(110%); 
            box-shadow: inset 0 0 40px rgba(255, 255, 255, 0.4), 0 25px 50px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 36px;
            transform: translateZ(0);
        }

        /* --- CTA BUTTONS --- */
        .cta-button {
            /* Default: Slightly lighter background for "uplifted" look */
            background-color: rgba(255, 255, 255, 0.12);
            /* White highlight above (inset), Shadow below (drop) */
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 2px 4px rgba(0, 0, 0, 0.1);
            
            color: #000000; 
            transition: transform 0.1s cubic-bezier(0.25, 0.46, 0.45, 0.94), background-color 0.2s ease, box-shadow 0.2s ease;
            border: none;
            border-radius: 24px; 
            user-select: none;
            cursor: pointer;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        @media (hover: hover) {
            .cta-button:hover {
                transform: translateY(-1px);
                background-color: rgba(255, 255, 255, 0.2);
                box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5), 0 4px 6px rgba(0, 0, 0, 0.12);
            }
        }
        
        .cta-button.active-manual {
            transform: scale(0.96) translateY(1px) !important; 
            background-color: rgba(0, 0, 0, 0.05) !important;
            
            /* Active: Shadow above (inner top), White line below (inner bottom) -> Fused Inwards */
            box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.15), inset 0 -1px 0 rgba(255, 255, 255, 0.3) !important;
            
            transition: transform 0.05s ease, box-shadow 0.05s ease;
        }

        /* Glass Inset Panel (Title Cards, Description Box, Filename Box) */
        .glass-inset-panel {
            /* Default: Uplifted (Fused Outwards) */
            background-color: rgba(255, 255, 255, 0.12);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 20px;
            border: none;
            transition: all 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            -webkit-tap-highlight-color: transparent;
        }

        .glass-inset-panel.interactive {
            cursor: pointer;
        }

        @media (hover: hover) {
            .glass-inset-panel.interactive:hover {
                transform: translateY(-1px);
                background-color: rgba(255, 255, 255, 0.15);
                box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5), 0 4px 6px rgba(0, 0, 0, 0.12);
            }
        }

        /* Clicked State: Fused Inwards */
        .glass-inset-panel.interactive.active-state {
            transform: scale(0.98);
            background-color: rgba(0, 0, 0, 0.05);
            /* Inner shadow top, White line bottom */
            box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.15), inset 0 -1px 0 rgba(255, 255, 255, 0.3);
        }

        #description-text-container.interactive.active-state {
            transform: scale(0.99); /* Reduced scale for large box to prevent heavy shifting */
        }

        .fade-in-text {
            animation: fadeInText 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        @keyframes fadeInText {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .text-fade-out {
            opacity: 0 !important;
            transform: translateY(-4px) !important;
            transition: opacity 0.2s ease, transform 0.2s ease !important;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Icon Sizes */
        .header-icon { height: 3.8rem; width: 3.8rem; object-fit: contain; } 
        .share-icon { height: 3.2rem; width: 3.2rem; object-fit: contain; } 
        .shorts-icon { height: 3.5rem; width: 3.5rem; object-fit: contain; } 

        @media (min-width: 640px) {
            .header-icon { height: 5rem; width: 5rem; }
            .share-icon { height: 4.2rem; width: 4.2rem; }
            .shorts-icon { height: 4.5rem; width: 4.5rem; }
        }
    </style>
</head>
<body class="p-4 md:p-8" onload="initApp()" ontouchstart="">
    
    <div id="initial-loader">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="animate-spin opacity-50"><path d="M12 2v4"/><path d="M12 18v4"/><path d="M4.93 4.93l2.83 2.83"/><path d="M16.24 16.24l2.83 2.83"/><path d="M2 12h4"/><path d="M18 12h4"/><path d="M4.93 19.07l2.83-2.83"/><path d="M16.24 7.76l2.83-2.83"/></svg>
    </div>

    <div id="fixed-background"></div>
    <div class="max-w-4xl mx-auto">
        <div class="mb-8 sm:mb-12">
            <header id="app-header" class="glass-card fluid-transition px-3 py-3 sm:px-6 sm:py-5 flex flex-row items-center justify-between pre-load-hidden">
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <div class="w-[57px] h-[57px] sm:w-[84px] sm:h-[84px] flex-shrink-0 relative left-[5.3px] sm:left-[5.3px]">
                        <img src="https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10" alt="Logo" class="w-full h-full object-contain filter drop-shadow-sm">
                    </div>
                    <div class="text-left min-w-0 relative left-[6px] sm:left-[5.3px]">
                        <h1 class="text-xl sm:text-3xl font-bold text-black leading-tight truncate">FanPlusFollow</h1>
                    </div>
                </div>
                <div class="flex-shrink-0 ml-1">
                    <div class="w-[77px] h-[77px] sm:w-[121px] sm:h-[121px] relative right-[5.3px] sm:right-0">
                        <img src="https://manmohit2007.github.io/Manmohit2007/youtube.png" alt="YouTube" class="w-full h-full object-contain">
                    </div>
                </div>
            </header>
        </div>
        <main>
            <div id="upload-card" class="glass-card fluid-transition p-6 rounded-[36px] mb-8 sm:mb-12 pre-load-hidden">
                <div class="mb-4">
                    <h2 class="text-xl sm:text-3xl font-bold flex items-center gap-1 sm:gap-2 text-black">
                        <img src="https://manmohit2007.github.io/Manmohit2007/share.png" alt="Share" class="share-icon">
                        <span class="relative -top-[2px] -left-[2px]">Upload Video</span>
                    </h2>
                </div>
                <div class="p-1 min-h-[10rem] sm:min-h-[14rem]" id="upload-section-content"></div>
            </div>
            <div id="results-section"></div>
        </main>
        <div class="mt-8 sm:mt-12 w-full">
            <div id="promo-card" class="glass-card fluid-transition px-2 pb-5 pt-0 sm:px-3 sm:pb-8 sm:pt-1 max-w-4xl mx-auto pre-load-hidden"> 
                <div class="px-1 pb-1">
                    <div class="flex flex-col items-center">
                        <div class="w-72 sm:w-96 mb-0 -mt-5 sm:-mt-8">
                            <img src="https://manmohit2007.github.io/Manmohit2007/banner.png" alt="Logo" class="w-full h-auto object-contain filter drop-shadow-md">
                        </div>
                        <h3 class="text-xl sm:text-3xl font-bold text-center text-black -mt-9 sm:-mt-10">Boost Your Reach Today</h3>
                        <p class="text-black mt-1 text-center max-w-md text-xs sm:text-sm font-bold opacity-80 leading-tight">Join the community for exclusive growth insights.</p>
                        <div class="mt-4 sm:mt-6 flex flex-row w-full max-w-md sm:max-w-lg justify-center gap-[18px] sm:gap-[30.6px] px-2 sm:px-0">
                          <button class="cta-button flex-1 sm:flex-none sm:w-40 px-4 py-4 font-bold flex items-center justify-center text-lg sm:text-lg" onclick="handleExternalLink(this, 'https://www.youtube.com/@fanplusfollow')">
                            Subscribe
                          </button>
                          <button class="cta-button flex-1 sm:flex-none sm:w-40 px-4 py-4 font-bold flex items-center justify-center text-lg sm:text-lg" onclick="handleExternalLink(this, 'https://www.instagram.com/_manmohit_singh_/')">
                            Follow
                          </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let file = null;
        let currentFileName = ""; 
        let isProcessing = false;
        let isProcessed = false;
        let isUIBusy = false; 
        let titles = [];
        let description = "";
        let titlesFull = [];
        let descriptionFull = "";
        let currentTitleSetIndex = 0;
        let currentDescriptionIndex = 0;

        // --- ASSET PRELOADING ---
        const ASSETS_TO_PRELOAD = [
            'https://manmohit2007.github.io/Manmohit2007/brand_logo.png?v=10',
            'https://manmohit2007.github.io/Manmohit2007/youtube.png',
            'https://manmohit2007.github.io/Manmohit2007/share.png',
            'https://manmohit2007.github.io/Manmohit2007/banner.png',
            'https://manmohit2007.github.io/Manmohit2007/like.png',
            'https://manmohit2007.github.io/Manmohit2007/shorts.png',
            'background.png',
            'landscape.png'
        ];

        const preloadAssets = async () => {
            const promises = ASSETS_TO_PRELOAD.map(src => {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.src = src;
                    img.onload = resolve;
                    img.onerror = resolve; 
                });
            });

            try {
                // Wait for all assets or a max timeout of 4 seconds (fallback)
                await Promise.race([
                    Promise.all(promises),
                    new Promise(resolve => setTimeout(resolve, 4000))
                ]);
            } catch (e) {
                console.warn("Asset preload warning:", e);
            }
        };

        const initApp = async () => {
            await preloadAssets();
            
            // Hide Loader
            const loader = document.getElementById('initial-loader');
            if (loader) {
                loader.style.opacity = '0';
                loader.style.visibility = 'hidden';
            }

            // Show Wallpaper
            const bg = document.getElementById('fixed-background');
            if (bg) bg.style.opacity = '1';

            // Trigger Entry Animations
            document.getElementById('app-header').classList.remove('pre-load-hidden');
            document.getElementById('app-header').classList.add('card-animate');
            
            document.getElementById('upload-card').classList.remove('pre-load-hidden');
            document.getElementById('upload-card').classList.add('card-animate');
            
            document.getElementById('promo-card').classList.remove('pre-load-hidden');
            document.getElementById('promo-card').classList.add('card-animate');

            updateUI(); 
        };

        const YOUTUBE_CHANNEL_LINK = "https://www.youtube.com/@fanplusfollow";
        const INSTAGRAM_LINK = "https://www.instagram.com/_manmohit_singh_/";

        // --- ANIMATION HELPER ---
        const animateAndExecute = (element, action) => {
            if (isUIBusy) return; 
            isUIBusy = true;      
            
            const activeClass = element.classList.contains('cta-button') ? 'active-manual' : 'active-state';
            element.classList.add(activeClass);
            
            setTimeout(() => {
                element.classList.remove(activeClass);
                setTimeout(() => {
                    action(() => { isUIBusy = false; }); 
                }, 150); 
            }, 100); 
        };

        const handleExternalLink = (element, url) => {
            animateAndExecute(element, (done) => { 
                window.open(url, '_blank');
                done(); 
            });
        };

        const handleRegenerateTitlesClick = (element) => {
            animateAndExecute(element, (done) => regenerateTitles(done));
        };

        const handleRegenerateDescriptionClick = (element) => {
            animateAndExecute(element, (done) => regenerateDescription(done));
        };

        const handleCopyClick = (element, text, index) => {
            animateAndExecute(element, (done) => copyToClipboard(text, index, done));
        };

        const handleResetClick = (element) => {
            animateAndExecute(element, (done) => { 
                resetApp(); 
                done(); 
            });
        };

        const icon = (name, classes) => {
            const iconMap = {
                'Upload': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${classes}"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>`,
                'Copy': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${classes}"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>`,
                'Check': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${classes}"><polyline points="20 6 9 17 4 12"/></svg>`,
                'RotateCcw': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${classes}"><path d="M3 2v6h6"/><path d="M3 13a9 9 0 1 0 3-7.7L3 8"/></svg>`,
                'Loader': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="animate-spin ${classes}"><path d="M12 2v4"/><path d="M12 18v4"/><path d="M4.93 4.93l2.83 2.83"/><path d="M16.24 16.24l2.83 2.83"/><path d="M2 12h4"/><path d="M18 12h4"/><path d="M4.93 19.07l2.83-2.83"/><path d="M16.24 7.76l2.83-2.83"/></svg>`
            };
            return iconMap[name] || '';
        };

        const handleFileChange = (event) => {
            const selectedFile = event.target.files?.[0];
            if (selectedFile && selectedFile.type.startsWith("video/")) {
                file = selectedFile;
                currentFileName = file.name; 
                processFile();
            }
        };

        const processFile = () => {
            isProcessing = true; isProcessed = false; updateUI(); 
            setTimeout(() => {
                generateViralContent(); 
                isProcessing = false; isProcessed = true; updateUI(); 
            }, 1800);
        };

        const generateViralContent = () => { 
            if (!file) return;
            const fullVideoName = currentFileName.replace(/\.[^/.]+$/, "");
            let displayVideoName = fullVideoName.length > 20 ? fullVideoName.substring(0, 20) + "..." : fullVideoName;
            const getTemplates = (vName) => ({
                titles: [
                    [`ðŸ”¥ ULTIMATE ${vName} Guide! #fanplusfollow`, `ðŸ“ˆ ${vName}: How We Went VIRAL! #fanplusfollow`, `ðŸ¤¯ This ${vName} Hack is Insane! #fanplusfollow`],
                    [`ðŸš€ ${vName} HACK: More Views! #fanplusfollow`, `ðŸ’¡ One ${vName} Tip That Works... #fanplusfollow`, `ðŸš« Stop Making Bad ${vName} Videos! #fanplusfollow`],
                    [`ðŸ¤« The ${vName} Secret Nobody Tells You... #fanplusfollow`, `âš ï¸ Don't Upload ${vName} Until You Watch This! #fanplusfollow`, `ðŸš€ From 0 to 10k Views with ${vName} #fanplusfollow`],
                    [`ðŸ’Ž ${vName} Masterclass: Pro Secrets Revealed #fanplusfollow`, `âš¡ Fast Track Your Growth: ${vName} Explained #fanplusfollow`, `ðŸ§  Psychology of ${vName}: Why It Works #fanplusfollow`],
                    [`ðŸ’¥ Break the Algorithm with ${vName}! #fanplusfollow`, `ðŸ›‘ The BIGGEST ${vName} Mistake Creators Make #fanplusfollow`, `âœ¨ Perfect ${vName} Tutorial in 5 Minutes #fanplusfollow`]
                ],
                descriptions: [
                    `ðŸš€ Unlock the full potential of ${vName} with this comprehensive guide! Whether you're a beginner or a pro, these insights will help you skyrocket your engagement.\n\nðŸ“Œ IN THIS VIDEO:\n0:00 - Intro\n1:45 - Why ${vName} Matters\n4:20 - Step-by-Step Strategy\n8:15 - Secret Hack Revealed\n10:30 - Final Thoughts\n\nðŸ’¡ JOIN THE CREATOR COMMUNITY:\nSubscribe here: ${YOUTUBE_CHANNEL_LINK}\nFollow on IG: ${INSTAGRAM_LINK}\n\nðŸ‘‡ QUESTION OF THE DAY:\nWhat's your biggest challenge with ${vName}? Let me know in the comments!\n\n#${vName.replace(/\s+/g, '')} #ContentStrategy #GrowthTips #FanPlusFollow`,
                    
                    `ðŸ˜± You won't believe how much ${vName} can change your channel! I tested this strategy for 30 days and the results were SHOCKING.\n\nðŸ”¥ WHAT TO EXPECT:\n- ðŸŽ¥ Real results from this method\n- ðŸ“ˆ Actionable steps you can take today\n- ðŸ¤« The secret to consistency\n\nâœ… STAY CONNECTED:\nðŸ“¸ Instagram: ${INSTAGRAM_LINK}\nðŸ“º YouTube: ${YOUTUBE_CHANNEL_LINK}\n\nâœ¨ If you enjoyed this video, please hit that LIKE button and SUBSCRIBE for more daily tips!\n\n#Viral #Trending #CreatorEconomy #${vName.replace(/\s+/g, '')}`,

                    `âš¡ Want to master ${vName} in record time? This video breaks down exactly what you need to know to get results FAST.\n\nWe cover:\nâœ… The basics of ${vName}\nâœ… Advanced tips for maximum reach\nâœ… Common pitfalls to avoid\n\nDon't forget to LIKE and SUBSCRIBE if you found this helpful! It supports the channel and helps us bring you more value.\n\nðŸ”— Follow for daily updates:\nIG: ${INSTAGRAM_LINK}\nYT: ${YOUTUBE_CHANNEL_LINK}\n\n#${vName.replace(/\s+/g, '')} #QuickTips #SocialMediaGrowth #FanPlusFollow`,

                    `ðŸ§  Let's dive deep into the analytics behind ${vName}. Why does it work? How does the algorithm treat it? We're answering it all today.\n\nðŸ“Š KEY TAKEAWAYS:\n1. The "Hook" Strategy\n2. Retention Hacks\n3. Conversion Tactics\n\nJoin the #FanPlusFollow movement!\nðŸ‘‰ ${YOUTUBE_CHANNEL_LINK}\nðŸ‘‰ ${INSTAGRAM_LINK}\n\nComment "GROWTH" below if you watched until the end!\n\n#${vName.replace(/\s+/g, '')} #Analytics #YouTubeTips #InstagramTips`,

                    `ðŸ“– I tried ${vName} so you don't have to... here is what happened. The journey was unexpected, but the lessons are invaluable for any creator trying to grow right now.\n\nTimestamps:\n0:00 - The Experiment\n3:10 - The Struggle\n6:45 - The Breakthrough\n9:00 - The Results\n\nIf you're serious about growth, you need to see this.\n\nðŸŒŸ Support the Channel:\nSubscribe: ${YOUTUBE_CHANNEL_LINK}\nFollow: ${INSTAGRAM_LINK}\n\n#${vName.replace(/\s+/g, '')} #CaseStudy #CreatorJourney #FanPlusFollow`
                ]
            });
            const displayTemplates = getTemplates(displayVideoName);
            const fullTemplates = getTemplates(fullVideoName);
            titles = displayTemplates.titles[currentTitleSetIndex % displayTemplates.titles.length];
            description = displayTemplates.descriptions[currentDescriptionIndex % displayTemplates.descriptions.length];
            titlesFull = fullTemplates.titles[currentTitleSetIndex % fullTemplates.titles.length];
            descriptionFull = fullTemplates.descriptions[currentDescriptionIndex % fullTemplates.descriptions.length];
        };

        const regenerateTitles = (done) => {
            if (!file || isProcessing) {
                if (done) done();
                return;
            }
            const elements = document.querySelectorAll('#titles-grid-container .fade-in-text');
            elements.forEach(el => el.classList.add('text-fade-out'));
            setTimeout(() => {
                currentTitleSetIndex++;
                generateViralContent(); 
                updateTitlesContent(); 
                if (done) done();
            }, 200);
        };

        const regenerateDescription = (done) => {
            if (!file || isProcessing) {
                if (done) done();
                return;
            }
            const container = document.getElementById('description-text-container');
            const textEl = container ? container.querySelector('.fade-in-text') : null;
            if (textEl) textEl.classList.add('text-fade-out');
            setTimeout(() => {
                currentDescriptionIndex++;
                generateViralContent(); 
                updateDescriptionContent(); 
                if (done) done();
            }, 200);
        };

        const handleRegenerate = () => {
            currentTitleSetIndex++; currentDescriptionIndex++;
            generateViralContent(); updateTitlesContent(); updateDescriptionContent();
        };

        const copyToClipboard = (text, index, done) => {
            const tempElement = document.createElement('textarea');
            tempElement.value = text;
            document.body.appendChild(tempElement);
            tempElement.select();
            document.execCommand('copy');
            document.body.removeChild(tempElement);

            if (index === 3) {
                const container = document.getElementById('description-text-container');
                if (container) {
                    container.style.transition = 'none';
                    const currentHeight = container.offsetHeight;
                    container.style.height = `${currentHeight}px`;

                    const contentDiv = container.querySelector('div');
                    
                    if (contentDiv) contentDiv.classList.add('text-fade-out');

                    setTimeout(() => {
                        container.style.display = 'flex';
                        container.style.flexDirection = 'column';
                        container.style.justifyContent = 'center';
                        
                        // Modified: Added text-base sm:text-lg to make "Copied" bigger on desktop
                        container.innerHTML = `<span class="flex items-center justify-center gap-1 w-full font-bold text-black/80 fade-in-text text-base sm:text-lg">${icon('Check', 'h-5 w-5')} Copied</span>`;
                        
                        setTimeout(() => { 
                            const span = container.querySelector('span');
                            if (span) {
                                span.classList.remove('fade-in-text');
                                span.classList.add('text-fade-out');
                            }
                            
                            setTimeout(() => {
                                container.style.display = '';
                                container.style.flexDirection = '';
                                container.style.justifyContent = '';
                                container.style.height = ''; 
                                container.style.transition = ''; 
                                
                                container.innerHTML = `<div class="whitespace-pre-wrap break-words text-xs sm:text-sm font-bold text-black/90 fade-in-text text-left w-full font-sans leading-relaxed pointer-events-none">${description}</div>`;
                                
                                if (done) done(); 
                            }, 200); 
                        }, 800); 
                    }, 200); 
                } else {
                    if (done) done();
                }
            } else {
                const card = document.getElementById(`title-card-${index}`);
                const originalText = titles[index];
                if (card) {
                    card.style.transition = 'none';
                    const p = card.querySelector('p');
                    p.classList.add('text-fade-out');

                    setTimeout(() => {
                        p.classList.remove('text-fade-out');
                        // Modified: Added text-base to make copied text bigger on mobile
                        p.innerHTML = `<span class="flex items-center justify-center gap-1 w-full fade-in-text text-base">${icon('Check', 'h-4 w-4')} Copied</span>`;
                        
                        setTimeout(() => { 
                            const span = p.querySelector('span');
                            if (span) {
                                span.classList.remove('fade-in-text');
                                span.classList.add('text-fade-out');
                            }

                            setTimeout(() => {
                                p.textContent = originalText;
                                p.classList.remove('text-fade-out');
                                void p.offsetWidth; 
                                p.classList.add('fade-in-text');
                                card.style.transition = ''; 
                                if (done) done(); 
                            }, 200);
                        }, 800);
                    }, 200);
                } else {
                    if (done) done();
                }
            }
        };

        const resetApp = () => { file = null; currentFileName = ""; isProcessing = false; isProcessed = false; updateUI(); };

        // New specific handler for the Select File button to fix touch responsiveness
        const handleSelectFileBtnClick = (event, btnElement) => {
            event.stopPropagation(); // Prevent the container's click from firing
            animateAndExecute(btnElement, (done) => {
                document.getElementById('file-upload-input').click();
                btnElement.blur(); // Remove focus to prevent sticky hover state on touch
                done(); 
            });
        };

        // Handler for the drop area container
        const handleDropAreaClick = (event) => {
            const btn = document.querySelector('#file-drop-area .cta-button');
            if (btn) {
                animateAndExecute(btn, (done) => {
                    document.getElementById('file-upload-input').click();
                    done(); 
                });
            }
        };

        const renderUploadSection = () => {
            const container = document.getElementById('upload-section-content');
            if (!file) {
                // Modified: Added onclick handlers directly to button and div for better touch response
                // Added pointer-events-none to text/icon so clicks fall through to the container cleanly
                container.innerHTML = `
                    <div id="file-drop-area" class="w-full h-full flex flex-col items-center justify-center text-center cursor-pointer pb-4" onclick="handleDropAreaClick(event)">
                        <div class="mb-4 pointer-events-none">${icon('Upload', 'h-12 w-12')}</div>
                        <p class="text-lg sm:text-xl font-bold text-black pointer-events-none">Upload Your Video File Here</p>
                        <button class="cta-button mt-6 px-6 py-4 font-bold text-lg" onclick="handleSelectFileBtnClick(event, this)">Select File</button>
                        <input type="file" id="file-upload-input" class="hidden" accept="video/*" onchange="handleFileChange(event)" onclick="event.stopPropagation()"/>
                    </div>`;
                
                // Removed the previous dynamic onclick attachment since we now use inline handlers
            } else {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full w-full pt-4 sm:pt-10">
                        <div class="w-full mb-6 flex justify-center px-1">
                            <div 
                                class="glass-inset-panel inline-flex items-center justify-center px-4 py-3 sm:px-6 sm:py-4 max-w-full ${isProcessed ? 'interactive cursor-pointer' : ''}" 
                                ${isProcessed ? 'onclick="handleResetClick(this)"' : ''}
                            >
                                <p class="font-bold text-black/80 truncate text-center gap-2 max-w-[60vw] sm:max-w-lg">
                                    ${currentFileName}
                                </p>
                            </div>
                        </div>
                        <!-- Modified: Added text-base sm:text-lg to make Analysis Complete text bigger on desktop -->
                        <div class="relative inline-flex items-center justify-center mb-2 font-bold left-[5.3px] text-base sm:text-lg">
                            <div class="absolute right-full top-1/2 -translate-y-1/2 pr-2 flex items-center">
                                ${!isProcessed ? icon('Loader', 'h-5 w-5') : icon('Check', 'h-5 w-5')}
                            </div>
                            <span class="opacity-80">${isProcessed ? 'Analysis Complete' : 'Analyzing Video...'}</span>
                        </div>
                    </div>`;
            }
        };

        const updateTitlesContent = () => {
            const grid = document.getElementById('titles-grid-container');
            if (!grid) return;
            grid.innerHTML = titles.map((title, index) => `
                <div id="title-card-${index}" class="glass-inset-panel interactive p-4 flex flex-col justify-center h-32 sm:h-40" onclick="handleCopyClick(this, '${titlesFull[index].replace(/'/g, "\\'")}', ${index})">
                    <p class="text-sm sm:text-base font-bold text-black/90 fade-in-text text-center line-clamp-4">${title}</p>
                </div>`).join('');
        };

        const updateDescriptionContent = () => {
            const container = document.getElementById('description-text-container');
            if (container) {
                container.setAttribute('onclick', `handleCopyClick(this, descriptionFull, 3)`);
                container.className = "glass-inset-panel p-4 interactive cursor-pointer h-[32rem] sm:h-[25rem] overflow-hidden";
                container.innerHTML = `<div class="whitespace-pre-wrap break-words text-xs sm:text-sm font-bold text-black/90 fade-in-text text-left w-full font-sans leading-relaxed pointer-events-none">${description}</div>`;
            }
        };

        const renderResults = () => {
            const container = document.getElementById('results-section');
            if (!isProcessed) { container.innerHTML = ''; return; }
            container.innerHTML = `
                <div class="glass-card p-4 sm:p-6 rounded-[36px] mb-8 sm:mb-12">
                    <div class="flex justify-between items-center mb-6 gap-2">
                        <h2 class="text-xl sm:text-3xl font-bold flex items-center gap-1 sm:gap-2"><img src="https://manmohit2007.github.io/Manmohit2007/like.png" class="header-icon"> <span class="relative -left-[9px]">Titles</span></h2>
                        <button onclick="handleRegenerateTitlesClick(this)" class="cta-button text-xs sm:text-sm px-3 py-2 sm:px-4 sm:py-2 font-bold flex items-center shrink-0" style="border-radius: 14px;">${icon('RotateCcw', 'mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4')} Regenerate</button>
                    </div>
                    <div id="titles-grid-container" class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"></div>
                </div>
                <div class="glass-card p-4 sm:p-6 rounded-[36px]">
                    <div class="flex justify-between items-center mb-4 gap-2">
                        <h2 class="text-xl sm:text-3xl font-bold flex items-center gap-1 sm:gap-2"><img src="https://manmohit2007.github.io/Manmohit2007/shorts.png" class="shorts-icon"> <span class="relative -left-[3px]">Description</span></h2>
                        <button onclick="handleRegenerateDescriptionClick(this)" class="cta-button text-xs sm:text-sm px-3 py-2 sm:px-4 sm:py-2 font-bold flex items-center shrink-0" style="border-radius: 14px;">${icon('RotateCcw', 'mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4')} Regenerate</button>
                    </div>
                    <div id="description-text-container" class="glass-inset-panel p-4 interactive cursor-pointer h-[32rem] sm:h-[25rem] overflow-hidden"></div>
                </div>`;
            updateTitlesContent(); updateDescriptionContent();
        };

        const updateUI = () => { renderUploadSection(); renderResults(); };
        // initApp is now async and handles preloading
    </script>
</body>
</html>
